(this["webpackJsonpmusic-player"]=this["webpackJsonpmusic-player"]||[]).push([[0],{13:function(e,t,n){e.exports=n.p+"static/media/spinner.2f27f045.ico"},14:function(e,t,n){e.exports=n(25)},19:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),r=n(11),s=n.n(r),o=(n(19),n(9)),l=n.n(o),c=n(6),u=n(1),h=n(2),d=n(4),m=n(3),y=n(5),p=n(12),f=n(8),v=n.n(f),g=n(7),w=n.n(g),P=(n(23),n(24),n(13)),b=n.n(P),k=function(){function e(t){Object(u.a)(this,e),this.audioContext=new AudioContext,this.lowPassFilter=this.audioContext.createBiquadFilter(),this.lowPassFilter.type="lowpass",this.highPassFilter=this.audioContext.createBiquadFilter(),this.highPassFilter.type="highpass",this.lowFreqAnalyser=this.audioContext.createAnalyser(),this.lowFreqAnalyser.fftSize=2048,this.highFreqAnalyser=this.audioContext.createAnalyser(),this.highFreqAnalyser.fftSize=2048,this.source=this.audioContext.createMediaElementSource(t),this.source.connect(this.lowPassFilter),this.source.connect(this.highPassFilter),this.lowPassFilter.connect(this.lowFreqAnalyser),this.highPassFilter.connect(this.highFreqAnalyser),this.source.connect(this.audioContext.destination)}return Object(h.a)(e,[{key:"getColor",value:function(){var e=this.lowFreqAnalyser.frequencyBinCount,t=new Uint8Array(e),n=new Uint8Array(e);this.lowFreqAnalyser.getByteTimeDomainData(t),this.highFreqAnalyser.getByteTimeDomainData(n);var a=Math.max.apply(Math,Object(c.a)(t)),i=128+Math.min(Math.exp((a-128)/10),128),r=Math.max.apply(Math,Object(c.a)(n)),s=128+Math.min(Math.exp((r-128)/10),128),o=(i+s)/2;return"rgb(".concat(i,", ").concat(s,", ").concat(o,")")}}]),e}(),S=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).onAudioElementRefAvailable=function(e){null!==e&&(n.visualizer=new k(e),n.currentAnimationId=requestAnimationFrame(n.draw))},n.draw=function(){document.body.style.backgroundColor=n.visualizer.getColor(),n.currentAnimationId=requestAnimationFrame(n.draw)},n.state={loadingStatus:e.isPlaying?"loading":null},n.audioElement=null,n.canvas=i.a.createRef(),n.currentAnimationId=null,n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentWillUnmount",value:function(){this.currentIntervalId&&clearInterval(this.currentIntervalId),this.stopVisualization()}},{key:"render",value:function(){var e=this,t=this.props.isPlaying?"filename playing":"filename";return this.props.isPlaying?"loading"===this.state.loadingStatus?i.a.createElement("div",{className:"Audio",onClick:function(){return e.onPausePressed()}},i.a.createElement("div",{className:"icon-container loading-spinner",role:"button"},i.a.createElement("img",{role:"img",src:b.a,className:"spinner",alt:"","aria-label":"Play"}),i.a.createElement("audio",{autoPlay:!0,crossOrigin:"anonymous",onCanPlay:function(){return e.onLoadingFinished()}},i.a.createElement("source",{src:this.props.url}))),i.a.createElement("div",{className:t},this.props.filename)):"loaded"===this.state.loadingStatus?i.a.createElement("div",{className:"Audio",onClick:function(){return e.onPausePressed()}},i.a.createElement("div",{className:"icon-container play-pause",role:"button"},i.a.createElement("span",{role:"img",className:"pause-symbol","aria-label":"Pause"},"|  |"),i.a.createElement("audio",{ref:this.onAudioElementRefAvailable,crossOrigin:"anonymous",autoPlay:!0,onEnded:function(){return e.props.onEnded()}},i.a.createElement("source",{src:this.props.url}))),i.a.createElement("div",{className:t},this.props.filename)):void 0:i.a.createElement("div",{className:"Audio",onClick:function(){return e.onPlayPressed()}},i.a.createElement("div",{className:"icon-container play-pause",role:"button"},i.a.createElement("span",{role:"img",className:"play-symbol","aria-label":"Play"},">")),i.a.createElement("div",{className:t},this.props.filename))}},{key:"onPlayPressed",value:function(){this.props.onPlayPressed()}},{key:"onLoadingFinished",value:function(){this.setState({loadingStatus:"loaded"})}},{key:"onPausePressed",value:function(){this.stopVisualization(),this.props.onPausePressed()}},{key:"stopVisualization",value:function(){document.body.style.backgroundColor="",cancelAnimationFrame(this.currentAnimationId),this.currentAnimationId=null}}]),t}(i.a.Component),E=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).handleOnPopState=function(e){var t="";e.state&&(t=e.state.searchString),n.setState({searchString:t}),n.doSearch(t)},n.handleKeyDown=function(e){"Control"===e.key&&n.setState({ctrlKeyDepressed:!0})},n.handleKeyUp=function(e){"Control"===e.key&&n.setState({ctrlKeyDepressed:!1})},n.renderFile=function(e){var t=n.state.currentlyPlaying.includes(e),a="".concat(e,"-").concat(t),r=n.props.s3Url+encodeURIComponent(e);return i.a.createElement("div",{className:"file-container",key:e},i.a.createElement(S,{url:r,isPlaying:t,key:a,filename:e,onPlayPressed:function(){return n.startPlaying(e)},onPausePressed:function(){return n.stopPlaying(e)},onEnded:function(){return n.onEnded(e)}}))},n.state={visibleFiles:null===e.filenames?null:[],searchString:e.searchString||"",currentlyPlaying:[],ctrlKeyDepressed:!1},n.searchBoxRef=i.a.createRef(),n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("popstate",this.handleOnPopState),window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("popstate",this.handleOnPopState),window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),this.currentTimeoutId&&clearTimeout(this.currentTimeoutId)}},{key:"componentDidUpdate",value:function(e,t,n){w.a.isEqual(this.props.filenames,e.filenames)||this.doSearch(this.state.searchString)}},{key:"render",value:function(){var e=this,t=this.state.visibleFiles,n=i.a.createElement("span",null,"Loading...");return i.a.createElement("div",{className:"SongList"},i.a.createElement("div",null,i.a.createElement("input",{placeholder:"Search...",autoFocus:!0,value:this.state.searchString,role:"searchbox",spellCheck:"false",ref:this.searchBoxRef,onFocus:function(e){return e.target.select()},onChange:function(t){return e.onSearchTermChanged(t.target.value)}}),i.a.createElement("button",{onClick:function(){return e.onNewClicked()}},"New Search")),i.a.createElement("div",{style:{marginTop:"1rem"}},t&&t.map(this.renderFile)||n))}},{key:"onNewClicked",value:function(){this.searchBoxRef.current.select()}},{key:"onSearchTermChanged",value:function(e){var t=this;this.setState({searchString:e}),this.currentTimeoutId&&clearTimeout(this.currentTimeoutId);this.currentTimeoutId=setTimeout((function(){t.doSearch(e),t.saveSearchString(e)}),750)}},{key:"doSearch",value:function(e){var t=e.toLowerCase();if(""!==t){var n=this.props.filenames.filter((function(e){return e.toLowerCase().includes(t)}));this.setState({visibleFiles:n})}else this.setState({visibleFiles:[]})}},{key:"saveSearchString",value:function(e){var t=new URLSearchParams(window.location.search);t.set("search",e),window.history.pushState({searchString:e},"",window.location.origin+window.location.pathname+"?"+t.toString())}},{key:"onEnded",value:function(e){var t=this,n=this.state.visibleFiles.indexOf(e)+1,a=this.state.currentlyPlaying;if(a=a.filter((function(t){return t!==e})),n<this.state.visibleFiles.length){var i=this.state.visibleFiles[n];a.push(i)}this.setState({currentlyPlaying:a},(function(){return t.setDocumentTitle()}))}},{key:"startPlaying",value:function(e){var t,n=this;t=this.state.ctrlKeyDepressed?this.state.currentlyPlaying.concat([e]):[e],this.setState({currentlyPlaying:t},(function(){return n.setDocumentTitle()}))}},{key:"stopPlaying",value:function(e){var t=this;this.setState({currentlyPlaying:this.state.currentlyPlaying.filter((function(t){return t!==e}))},(function(){return t.setDocumentTitle()}))}},{key:"setDocumentTitle",value:function(){var e=this.state.currentlyPlaying[0],t=e&&w.a.last(e.split("/"));document.title=t?"\ud83c\udfb6 \u2014 ".concat(t):"\ud83c\udfb6"}}]),t}(i.a.Component),C="https://elis-music.s3.us-east-2.amazonaws.com/";function F(){return(F=Object(p.a)(l.a.mark((function e(){var t,n,a,i,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=null;case 2:return a="list-type=2",n&&(a+="&continuation-token=".concat(encodeURIComponent(n))),e.next=7,fetch(C+"?"+a);case 7:return i=e.sent,e.next=10,i.text();case 10:if(r=e.sent,s=v()(r).find("Contents > Key").toArray().map((function(e){return e.textContent})),t.push.apply(t,Object(c.a)(s)),"true"===v()(r).find("IsTruncated").text()){e.next=15;break}return e.abrupt("break",18);case 15:n=v()(r).find("NextContinuationToken").text(),e.next=2;break;case 18:return e.abrupt("return",t);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={keys:null},n}return Object(y.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;(function(){return F.apply(this,arguments)})().then((function(t){return e.setState({keys:t})}))}},{key:"render",value:function(){var e=new URLSearchParams(window.location.search).get("search");return i.a.createElement(E,{filenames:this.state.keys,s3Url:C,searchString:e})}}]),t}(i.a.Component);s.a.render(i.a.createElement(A,null),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.a66b1e64.chunk.js.map